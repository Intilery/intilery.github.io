"use strict";(self.webpackChunkintilery=self.webpackChunkintilery||[]).push([[2975],{2186:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"schema/identify","title":"Identify Schema","description":"identify lets you tie a user to their actions and record traits about them. It includes a unique User ID and any optional traits you know about them like their email, name, etc.","source":"@site/docs/schema/identify.md","sourceDirName":"schema","slug":"/schema/identify","permalink":"/docs/schema/identify","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"identify","title":"Identify Schema","sidebar_label":"Identify"},"sidebar":"schema","previous":{"title":"SMS","permalink":"/docs/schema/sms"},"next":{"title":"Track","permalink":"/docs/schema/track"}}');var i=s(4848),r=s(8453);const a={id:"identify",title:"Identify Schema",sidebar_label:"Identify"},c=void 0,l={},d=[{value:"Marketing Preferences",id:"marketing-preferences",level:3},{value:"Example",id:"example",level:2},{value:"Identities",id:"identities",level:2},{value:"Anonymous ID",id:"anonymous-id",level:3},{value:"User ID",id:"user-id",level:3},{value:"Traits",id:"traits",level:2},{value:"Multi-value traits",id:"multi-value-traits",level:4},{value:"Array based traits",id:"array-based-traits",level:4},{value:"Customer Campaign",id:"customer-campaign",level:4},{value:"Asynchronous Processing",id:"asynchronous-processing",level:3},{value:"Timing",id:"timing",level:4},{value:"Should I use Traits or Event Data?",id:"should-i-use-traits-or-event-data",level:3}];function o(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"identify"})," lets you tie a user to their actions and record traits about them. It includes a unique User ID and any optional traits you know about them like their email, name, etc."]}),"\n",(0,i.jsxs)(n.p,{children:["Our recommendation for when and how often you should call ",(0,i.jsx)(n.code,{children:"identify"})," is as follows:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["After a user registers","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"You should set the source, medium and campaign traits at this time"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"After a user logs in"}),"\n",(0,i.jsx)(n.li,{children:"When a user updates their info (eg changes or adds a new address)"}),"\n",(0,i.jsx)(n.li,{children:"Upon loading any pages that are accessible by a logged in user (optional)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.em,{children:[(0,i.jsx)(n.strong,{children:"Note:"})," You should configure the accessability of customer traits to non-authenticated APIs (e.g. ",(0,i.jsx)(n.a,{href:"/docs/tag/tag1",children:"Analytics.js"}),") by default, customer traits are not able to be updated via non-authenticated APIs unless the accessor is set to do so."]})," (coming soon)"]}),"\n",(0,i.jsxs)(n.p,{children:["Calling ",(0,i.jsx)(n.code,{children:"identify"})," in the ",(0,i.jsx)(n.a,{href:"/docs/tag/tag1",children:"Website Tag"})," or ",(0,i.jsx)(n.a,{href:"/docs/apis/api",children:"HTTP API"})," is the first step to integrating and using Intilery."]}),"\n",(0,i.jsxs)(n.p,{children:["Here\u2019s the payload of a typical ",(0,i.jsx)(n.code,{children:"identify"})," call with most ",(0,i.jsx)(n.a,{href:"/docs/schema/common",children:"common fields"})," removed:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "userId": "97980cfea0067",\n  "event": "identify",\n  "traits": {\n    "name": "Peter Gibbons",\n    "email": "peter@example.com",\n    "plan": "premium",\n    "campaign": {\n      "source": "google",\n      "medium": "cpc",\n      "name": "free trial"\n    },\n    "marketingPreferences": { \n      "channels": [ \n        { "channel": "email", "subscribed": true },\n        { "channel": "sms", "subscribed": true },\n        { "channel": "whatsapp", "subscribed": false },\n        { "channel": "facebook", "subscribed": false },\n        { "channel": "push", "subscribed": false }\n      ] \n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"And here\u2019s the corresponding Javascript event that would generate the above payload:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'analytics.identify("97980cfea0067", {\n  name: "Peter Gibbons",\n  email: "peter@example.com",\n  plan: "premium",\n  campaign: {\n    source : "google",\n    medium : "cpc",\n    name: "free trial"\n  },\n  "marketingPreferences": { \n      "channels": [ \n        { "channel": "email", "subscribed": true },\n        { "channel": "sms", "subscribed": true },\n        { "channel": "whatsapp", "subscribed": false },\n        { "channel": "facebook", "subscribed": false },\n        { "channel": "push", "subscribed": false }\n      ] \n    }\n});\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Beyond the common fields, an ",(0,i.jsx)(n.code,{children:"identify"})," call has the following fields:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Field"}),(0,i.jsx)(n.th,{}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"traits"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.em,{children:"optional"})}),(0,i.jsx)(n.td,{children:"Object"}),(0,i.jsxs)(n.td,{children:["Free-form dictionary of traits of the user, like ",(0,i.jsx)(n.code,{children:"email"})," or ",(0,i.jsx)(n.code,{children:"name"}),". See the ",(0,i.jsx)(n.a,{href:"#traits",children:"Traits field docs"})," for a list of reserved trait names."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"userId"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.em,{children:"optional if anonymousID is set instead"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:["Unique identifier for the user in your database. A userId or an anonymousId is required. See the ",(0,i.jsx)(n.a,{href:"#identities",children:"Identities docs"})," for more details."]})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"marketing-preferences",children:"Marketing Preferences"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"Note:"})})," The trait Marketing Preferences is a system trait for setting the channel level subscription to marketing channels"]}),"\n",(0,i.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,i.jsxs)(n.p,{children:["Here\u2019s a complete example of an ",(0,i.jsx)(n.code,{children:"identify"})," call:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "anonymousId": "507f191e810c19729de860ea",\n  "channel": "browser",\n  "context": {\n    "ip": "8.8.8.8",\n    "campaign" : {\n      "name" : "campaign name",\n      "source" : "Google",\n      "medium" : "ppc"\n    },\n    "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.115 Safari/537.36"\n  },\n  "messageId": "022bb90c-bbac-11e4-8dfc-aa07a5b093db",\n  "receivedAt": "2015-02-23T22:28:55.387Z",\n  "sentAt": "2015-02-23T22:28:55.111Z",\n  "timestamp": "2015-02-23T22:28:55.111Z",\n  "traits": {\n    "name": "Peter Gibbons",\n    "email": "peter@example.com",\n    "plan": "premium",\n    "logins": 5,\n    "address": {\n      "number": "1",\n      "street": "Station Road",\n      "city": "Chester",\n      "county": "Cheshire",\n      "postalCode": "CH1",\n      "country": "UK"\n    }\n  },\n  "type": "identify",\n  "userId": "97980cfea0067",\n  "version": "1.1"\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"identities",children:"Identities"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"identify"})," call specifies a customer identity that you can reference across the customer\u2019s whole lifetime. ",(0,i.jsxs)(n.strong,{children:["Every ",(0,i.jsx)(n.code,{children:"identify"})," call must have a ",(0,i.jsx)(n.a,{href:"#user-id",children:"User ID"})," or an ",(0,i.jsx)(n.a,{href:"#anonymous-id",children:"Anonymous ID"})]}),", depending on how much you know about the user in question."]}),"\n",(0,i.jsx)(n.h3,{id:"anonymous-id",children:"Anonymous ID"}),"\n",(0,i.jsx)(n.p,{children:"There are certain cases where you don\u2019t actually know who the user is according to your database, but you still want to be able to tie them to traits, events or page views. For example, you may not know who a user is when tracking newsletter signups or anonymous page views."}),"\n",(0,i.jsx)(n.p,{children:"In these cases, you should use an Anonymous ID."}),"\n",(0,i.jsxs)(n.p,{children:["The Anonymous ID can be any pseudo-unique identifier. For example, on your servers you can use a session id. If you don\u2019t have any readily available identifier, you can always generate a new random one\u2014we recommend ",(0,i.jsx)(n.a,{href:"http://en.wikipedia.org/wiki/Universally_unique_identifier",children:"UUIDs"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note:"})," Our ",(0,i.jsx)(n.a,{href:"/docs/tag/tag1",children:"Website Tag"})," ",(0,i.jsx)(n.strong,{children:"automatically"})," use Anonymous IDs under the covers to keep track of users as they navigate around your website or app, so you don\u2019t need to worry about them when using those libraries."]}),"\n",(0,i.jsx)(n.p,{children:"Here\u2019s an example of a Javascript event for an anonymous user:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"analytics.identify({\n  subscriptionStatus: 'inactive'\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"user-id",children:"User ID"}),"\n",(0,i.jsxs)(n.p,{children:["User IDs are a more permanent and robust identifier, like a database ID. Since these IDs are consistent across a customer\u2019s lifetime, ",(0,i.jsx)(n.code,{children:"identify"})," calls should include a User ID as often as possible."]}),"\n",(0,i.jsxs)(n.p,{children:["A User ID is usually the unique identifier that you recognize a user by in your own database. For example, if you\u2019re using MongoDB it might look something like ",(0,i.jsx)(n.code,{children:"507f191e810c19729de860ea"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["We recommend using database IDs instead of simple email addresses or usernames, because database IDs ",(0,i.jsx)(n.em,{children:"never"})," change. That guarantees that even if the user changes their email address, you can still recognize them as the same person in all of your analytics tools. And even better, you\u2019ll be able to correlate analytics data with your own internal database."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Instead of using an email address or a username as a User ID, send them along as ",(0,i.jsx)(n.a,{href:"#traits",children:"traits"}),"."]})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"Note:"})}),' When looking at events or customers in the Intilery platform, you may see references to "customerId", this is the internal unique ID for the customer that Intilery assigns. This ID is for Intilery use only.']}),"\n",(0,i.jsx)(n.h2,{id:"traits",children:"Traits"}),"\n",(0,i.jsxs)(n.p,{children:["Traits are pieces of information you know about a user that are included in an ",(0,i.jsx)(n.code,{children:"identify"})," call. These could be demographics like ",(0,i.jsx)(n.code,{children:"age"})," or ",(0,i.jsx)(n.code,{children:"gender"}),", account-specific like ",(0,i.jsx)(n.code,{children:"plan"}),", or even things like whether a user has seen a particular A/B test variation. Up to you!"]}),"\n",(0,i.jsxs)(n.p,{children:["We\u2019ve reserved some traits that have semantic meanings for users, and we handle them in special ways. For example, we always expect ",(0,i.jsx)(n.code,{children:"email"})," to be a string of the user\u2019s email address. We use this when sending emails to the customer"]}),"\n",(0,i.jsxs)(n.p,{children:["You should ",(0,i.jsx)(n.strong,{children:"only use reserved traits for their intended meaning"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Reserved traits we\u2019ve standardized:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Trait"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Type"})}),(0,i.jsx)(n.th,{children:(0,i.jsx)(n.strong,{children:"Description"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"address"})}),(0,i.jsx)(n.td,{children:"Object"}),(0,i.jsxs)(n.td,{children:["Street address of a user optionally containing: ",(0,i.jsx)(n.code,{children:"city"}),", ",(0,i.jsx)(n.code,{children:"country"}),", ",(0,i.jsx)(n.code,{children:"postalCode"}),", ",(0,i.jsx)(n.code,{children:"state"})," or ",(0,i.jsx)(n.code,{children:"street"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"age"})}),(0,i.jsx)(n.td,{children:"Number"}),(0,i.jsx)(n.td,{children:"Age of a user"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"avatar"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"URL to an avatar image for the user"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"birthday"})}),(0,i.jsx)(n.td,{children:"Date"}),(0,i.jsx)(n.td,{children:"User\u2019s birthday"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"company"})}),(0,i.jsx)(n.td,{children:"Object"}),(0,i.jsxs)(n.td,{children:["Company the user represents, optionally containing: ",(0,i.jsx)(n.code,{children:"name"})," (a String), ",(0,i.jsx)(n.code,{children:"id"})," (a String or Number), ",(0,i.jsx)(n.code,{children:"industry"})," (a String), ",(0,i.jsx)(n.code,{children:"employee_count"})," (a Number) or ",(0,i.jsx)(n.code,{children:"plan"})," (a String)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"createdAt"})}),(0,i.jsx)(n.td,{children:"Date"}),(0,i.jsxs)(n.td,{children:["Date the user\u2019s account was first created. We recommend ",(0,i.jsx)(n.a,{href:"http://en.wikipedia.org/wiki/ISO_8601",children:"ISO-8601"})," date strings."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"campaign"})}),(0,i.jsx)(n.td,{children:"Object"}),(0,i.jsxs)(n.td,{children:["Identifies a specific product promotion or strategic campaign that created the customer, has keys: ",(0,i.jsx)(n.code,{children:"medium"}),", ",(0,i.jsx)(n.code,{children:"source"}),", ",(0,i.jsx)(n.code,{children:"name"})," with string values."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"content"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:["Identifies what specifically was clicked to bring the user to the site, such as a ",(0,i.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Banner_ad",children:"banner ad"})," or a ",(0,i.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Hyperlink",children:"text link"}),". It is often used for ",(0,i.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/A/B_testing",children:"A/B testing"})," and ",(0,i.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Contextual_advertising",children:"content-targeted ads"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"description"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Description of the user"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"email"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Email address of a user"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"firstName"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"First name of a user"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"gender"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Gender of a user"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"id"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Unique ID in your database for a user"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"lastName"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Last name of a user"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"name"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Full name of a user. If you only pass a first and last name we\u2019ll automatically fill in the full name for you."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"phone"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Phone number of a user"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"title"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Title of a user, usually related to their position at a specific company. Example: \u201cDirector of Engineering\u201d"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"username"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"User\u2019s username. This should be unique to each user, like the usernames of Twitter or GitHub."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"website"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Website of a user"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"marketingPreferences"})}),(0,i.jsx)(n.td,{children:"Object"}),(0,i.jsx)(n.td,{children:"Array of channels with a channel name and boolean subscribed: -"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"marketingPreferences: -"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{ \n\t"channels": [ \n\t\t{ "channel": "email", "subscribed": true },\n\t\t{ "channel": "sms", "subscribed": true },\n\t\t{ "channel": "whatsapp", "subscribed": false },\n\t\t{ "channel": "facebook", "subscribed": false },\n\t\t{ "channel": "push", "subscribed": false }\n\t] \n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Trait Updates"}),"\n",(0,i.jsxs)(n.p,{children:["Traits are designed to store the state of a customer, sending the a value for a trait either by the ",(0,i.jsx)(n.a,{href:"/docs/tag/reference#identify",children:"Analytics.js identify"})," or the ",(0,i.jsx)(n.a,{href:"/docs/apis/api#identify-action",children:"HTTP API identify"})," will result in the value of the trait being updating for the customer."]}),"\n",(0,i.jsx)(n.p,{children:"Changeable/transient values or multi-value traits should not be set as a single trait."}),"\n",(0,i.jsx)(n.p,{children:"Consider the following example: -"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'analytics.identify("97980cfea0067", {\n        "email": "joe.blogs@intilery.com",\n        "firstName": "Joe",\n        "phone": "123456789",\n        "policy": {\n            "policyType": "Private Car",\n            "policyNumber": "123"\n        }\n    });\n'})}),"\n",(0,i.jsx)(n.p,{children:"The resulting traits of the customer would be"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "traits": {\n    "clientReference": "something",\n     "email": "joe.blogs@intilery.com",\n     "firstName": "Joe",\n     "phone": "123456789",\n\t   "policy": {\n       "policyType": "Private Car",\n       "policyNumber": "123"\n    \t}\n\t}\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"If another identify request is made, but it omits traits, then only the traits supplied are updated/set, e.g. calling identify with"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'analytics.identify("97980cfea0067", {\n   "lastName": "Bloggs"\n});\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Would result in the ",(0,i.jsx)(n.code,{children:"lastName"})," trait being added to the customer's traits, e.g. resulting in"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "traits": {\n  \t  "clientReference": "something",\n    \t"email": "joe.blogs@intilery.com",\n\t    "firstName": "Joe",\n      "lastName" : "Bloggs",\n  \t  "phone": "123456789",\n\t    "policy": {\n  \t      "policyType": "Private Car",\n    \t    "policyNumber": "123"\n    \t}\n\t}\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"If you pass in a different value for a trait, the value of the trait is updated, i.e. calling identify with"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'analytics.identify("97980cfea0067", {\n   "firstName": "Josephh"\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:"Would result in the fistName trait being updated in the customer's traits, e.g. resulting in"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "traits": {\n  \t  "clientReference": "something",\n    \t"email": "joe.blogs@intilery.com",\n\t    "firstName": "Joseph",\n      "lastName" : "Bloggs",\n  \t  "phone": "123456789",\n\t    "policy": {\n  \t      "policyType": "Private Car",\n    \t    "policyNumber": "123"\n    \t}\n\t}\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note:"})," Special care should be taken when setting trait values when they are arrays or objects, the value passed in is what is set, example"]}),"\n",(0,i.jsx)(n.p,{children:"Starting with a customer that has traits previously set, e.g. resulting in"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "traits": {\n  \t  "clientReference": "something",\n    \t"email": "joe.blogs@intilery.com",\n\t    "firstName": "Joe",\n      "lastName" : "Bloggs",\n  \t  "phone": "123456789",\n\t    "policy": {\n  \t      "policyType": "Private Car",\n    \t    "policyNumber": "123"\n    \t}\n\t}\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["You then call ",(0,i.jsx)(n.code,{children:"identify"})," with the following"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "traits": {\n\t    "policy": {\n  \t      "policyType": "Private Car"\n    \t}\n\t}\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"The resulting customer traits would be the following"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "traits": {\n  \t  "clientReference": "something",\n    \t"email": "joe.blogs@intilery.com",\n\t    "firstName": "Joe",\n      "lastName" : "Bloggs"\n  \t  "phone": "123456789",\n\t    "policy": {\n  \t      "policyType": "Private Car",\n    \t}\n\t}\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["**Note: ** The value of the ",(0,i.jsx)(n.code,{children:"policy"})," trait has been update to match explicitly what you passed in the ",(0,i.jsx)(n.code,{children:"identify"})," call, note how the ",(0,i.jsx)(n.code,{children:"policyNumber"})," value in the ",(0,i.jsx)(n.code,{children:"policy"})," trait has been removed, as it was not present in the ",(0,i.jsx)(n.code,{children:"identify"})," call for the trait ",(0,i.jsx)(n.code,{children:"policy"})]}),"\n",(0,i.jsx)(n.h4,{id:"multi-value-traits",children:"Multi-value traits"}),"\n",(0,i.jsx)(n.p,{children:"If you require to store multiple traits of a same type, either use arrays or explicit properties for each value, e.g"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'analytics.identify("97980cfea0067", "traits": {\n        "email": "joe.blogs@intilery.com",\n        "firstName": "Joe",\n        "phone": "123456789"\n    });\n'})}),"\n",(0,i.jsx)(n.p,{children:".The resulting customer traits would be the following"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'{\n  "traits": {\n    "clientReference": "something",\n     "email": "joe.blogs@intilery.com",\n     "firstName": "Joe",\n     "phone": "123456789"\n\t}\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Adding a new policy to a named trait"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'analytics.identify("97980cfea0067", "traits": {\n      "car-policy": {\n  \t      "policyType": "Private Car",\n    \t    "policyNumber": "123"\n    \t}\n    });\n'})}),"\n",(0,i.jsx)(n.p,{children:".The resulting customer traits would be the following"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'{\n  "traits": {\n    "clientReference": "something",\n     "email": "joe.blogs@intilery.com",\n     "firstName": "Joe",\n     "phone": "123456789",\n      "car-policy": {\n  \t     "policyType": "Private Car",\n    \t   "policyNumber": "123"\n    \t}\n\t}\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Then to add a different policy"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'analytics.identify("97980cfea0067", "traits": {\n      "home-policy": {\n  \t      "policyType": "Home",\n    \t    "policyNumber": "456"\n    \t}\n    });\n'})}),"\n",(0,i.jsx)(n.p,{children:".The resulting customer traits would be the following"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'{\n  "traits": {\n    "clientReference": "something",\n     "email": "joe.blogs@intilery.com",\n     "firstName": "Joe",\n     "phone": "123456789",\n      "car-policy": {\n  \t     "policyType": "Private Car",\n    \t   "policyNumber": "123"\n    \t},\n        "home-policy": {\n        "policyType": "Home",\n        "policyNumber": "456"\n    \t}\n\t}\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note:"})," Both policies cpould have been set in a single ",(0,i.jsx)(n.code,{children:"indentify"})," call of course."]}),"\n",(0,i.jsxs)(n.p,{children:["**Note: ** It is advisable to keep the number of traits for multi value traits to under 20, if you require more values, then use an array, e.g. ",(0,i.jsx)(n.a,{href:"/docs/schema/retail",children:"products in cart"})," which is an array of products"]}),"\n",(0,i.jsx)(n.h4,{id:"array-based-traits",children:"Array based traits"}),"\n",(0,i.jsx)(n.p,{children:"To set an array of properties for a trait, e.g. multiple policies"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'analytics.identify("97980cfea0067", {\n      "policies": [\n       \t{\n  \t        "policyType": "Home",\n    \t    "policyNumber": "456"\n        },\n  \t\t{\n  \t        "policyType": "Private Car",\n    \t    "policyNumber": "123"\n    \t}\n    ]\t\n    });\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note:"})," You must pass in the complete array when setting an array based trait"]}),"\n",(0,i.jsx)(n.h4,{id:"customer-campaign",children:"Customer Campaign"}),"\n",(0,i.jsxs)(n.p,{children:["The identify method automatically sends the campaign data for the current session, as set via UTM parameters in the URL, as detailed here ",(0,i.jsx)(n.a,{href:"/docs/schema/common#context",children:"common fields"})," (see field campaign)."]}),"\n",(0,i.jsx)(n.p,{children:'If the campaign is set on the current context, by including UTM paramters (utm_medium, utm_campaign etc.). a customer trait "campaign" will be created with these details.'}),"\n",(0,i.jsx)(n.p,{children:"The campaign trait is only set on the customer when the customer is initially recognised, either as a known customer or an anonymous visitor, in which case the campaign value is copied over from the visitor to the customer"}),"\n",(0,i.jsx)(n.h3,{id:"asynchronous-processing",children:"Asynchronous Processing"}),"\n",(0,i.jsx)(n.p,{children:"The processing of all requests to the Intilery customer data platform is asynchronous,  each of the methods to call the CDP (Javascript tag or HTTP API) will return an eventID that represents the action requested, the format of the response is"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{ \n  "success": true, \n  "eventId": "3e112aa5-2bed-49a9-b1db-ead2b807066d" \n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"code"}),' "success" indicates whether the call was accepted and ',(0,i.jsx)(n.code,{children:"eventId"})," is the unique ID of this call (event). Any errors downstream will report this eventID."]}),"\n",(0,i.jsx)(n.h4,{id:"timing",children:"Timing"}),"\n",(0,i.jsxs)(n.p,{children:["Due to the nature of asynchronous processing, you should leave 500ms between an ",(0,i.jsx)(n.code,{children:"identify"})," call, and further calls that may need to access traits on the customer, for example email merge tags, this gives the asynchronous storage the time to sve the traits."]}),"\n",(0,i.jsx)(n.p,{children:"If it is imperative that the data is available to the campaign asset at the time of the call (not withstanding a 500ms gap between identify and other calls) then we recommend passing the merge tag data as part of the event, as the event object is passed to the downstream processor."}),"\n",(0,i.jsx)(n.h3,{id:"should-i-use-traits-or-event-data",children:"Should I use Traits or Event Data?"}),"\n",(0,i.jsx)(n.p,{children:"If the data belongs to the customer, and is a semi-immuttable value, then this should be stored in the customer traits, e.g. custome policies. These values change less frequently, than say an order conformation email, where the data for the email/letter is transient and only needed for that communication, e.g."}),"\n",(0,i.jsx)(n.p,{children:"To send an asset that has tranisent data, for example a renewal quote, you may decide to send this data as part of the event/command to send the asset, rather than implicitly setting it as a trait on the customer."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note:"})," Be aware of ",(0,i.jsx)(n.a,{href:"#asynchronous-processing",children:"Asynchronous Processing"})]}),"\n",(0,i.jsxs)(n.p,{children:["The send an asset with data for that send, which is attached to the event itself and passed down stream to the sending of the asset ",(0,i.jsx)(n.a,{href:"/docs/apis/commands",children:"API Commands"})]}),"\n",(0,i.jsx)(n.p,{children:"For example: -"}),"\n",(0,i.jsxs)(n.p,{children:["POST ",(0,i.jsx)(n.a,{href:"https://tracking.intilery.com/track/%7BclientId%7D/%7BaccountId%7D/%7BBRANDID%7D/v1/track",children:"https://tracking.intilery.com/track/{clientId}/{accountId}/{BRANDID}/v1/track"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "userId": "ABC/123",  \n    "event": "SEND_PRINT",  \n    "assetId": "renewal",  \n    "timestamp": "2019-11-18T13:30:12.984Z",\n     "renewal" : {\n       "price": "123.44",\n       "currency": "GBP"\n     }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The value for ",(0,i.jsx)(n.code,{children:"renewal"})," is a transient value that is used for the sending of that asset, if you require to set this on the customer trait first, then see above"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>c});var t=s(6540);const i={},r=t.createContext(i);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);