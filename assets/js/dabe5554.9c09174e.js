(self.webpackChunkintilery=self.webpackChunkintilery||[]).push([[8224],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return d},kt:function(){return c}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),m=p(n),c=r,k=m["".concat(s,".").concat(c)]||m[c]||u[c]||i;return n?a.createElement(k,l(l({ref:t},d),{},{components:n})):a.createElement(k,l({ref:t},d))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9727:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return o},metadata:function(){return s},toc:function(){return p},default:function(){return u}});var a=n(2122),r=n(9756),i=(n(7294),n(3905)),l={id:"api",title:"Event Tracking API Guide",sidebar_label:"API Guide"},o="API For Servers",s={unversionedId:"apis/api",id:"apis/api",isDocsHomePage:!1,title:"Event Tracking API Guide",description:"The Intilery HTTP Tracking API lets you record analytics data from",source:"@site/docs/apis/api.md",sourceDirName:"apis",slug:"/apis/api",permalink:"/docs/apis/api",version:"current",frontMatter:{id:"api",title:"Event Tracking API Guide",sidebar_label:"API Guide"},sidebar:"apis",next:{title:"Commands",permalink:"/docs/apis/commands"}},p=[{value:"Endpoint",id:"endpoint",children:[{value:"Headers",id:"headers",children:[]},{value:"Example Request",id:"example-request",children:[]},{value:"Permissions",id:"permissions",children:[]},{value:"Limits",id:"limits",children:[]},{value:"Response",id:"response",children:[]}]},{value:"Identify Action",id:"identify-action",children:[]},{value:"Track Action",id:"track-action",children:[]},{value:"Page Action",id:"page-action",children:[]},{value:"Screen Action",id:"screen-action",children:[]},{value:"Historical Import",id:"historical-import",children:[]},{value:"Batch",id:"batch",children:[]},{value:"Collecting IP Address",id:"collecting-ip-address",children:[]},{value:"Deletion and Suppression",id:"deletion-and-suppression",children:[{value:"Regulation types",id:"regulation-types",children:[]}]},{value:"Troubleshooting",id:"troubleshooting",children:[{value:"No events in my debugger",id:"no-events-in-my-debugger",children:[]}]}],d={toc:p};function u(e){var t=e.components,n=(0,r.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"api-for-servers"},"API For Servers"),(0,i.kt)("p",null,"The Intilery HTTP Tracking API lets you record analytics data from\nany website or application. The requests hit our servers, and we action\nthis in the Intilery CDP and Customer Engagement Platform"),(0,i.kt)("p",null,"Intilery has native libraries for integration for ",(0,i.kt)("a",{parentName:"p",href:"../tag/tag1"},"websites with JavaScript"),",\nand mobile devices running ",(0,i.kt)("a",{parentName:"p",href:"docs/app/ios"},"iOS")," and ",(0,i.kt)("a",{parentName:"p",href:"docs/app/android"},"Android")," that are all\nbuilt for high-performance. But sometimes you may want to send to the\nHTTP API directly \u2014 that\u2019s what this reference is for."),(0,i.kt)("h2",{id:"endpoint"},"Endpoint"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http",metastring:"request",request:!0},"https://tracking.intilery.com/track/{clientId}/{accountId}/{BRANDID}/v1/{action}\n")),(0,i.kt)("p",null,"You can determine the values of your clientId, accountId and BRANDID from the URL\nof your login to the Intilery platform:"),(0,i.kt)("p",null,"If you have only a single account this will be: ",(0,i.kt)("inlineCode",{parentName:"p"},"clientId.intilery.com")," and your ",(0,i.kt)("inlineCode",{parentName:"p"},"accountid"),"\nwill be the same as your ",(0,i.kt)("inlineCode",{parentName:"p"},"clientId"),"."),(0,i.kt)("p",null,"If you have multiple accounts this will be: ",(0,i.kt)("inlineCode",{parentName:"p"},"accountid.clientid.intilery.com"),"."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Field"),(0,i.kt)("th",{parentName:"tr",align:null}))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"clientId")),(0,i.kt)("td",{parentName:"tr",align:null},"The value in your login URL before ",(0,i.kt)("inlineCode",{parentName:"td"},"intilery.com"),". It will be lower case.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"accountId")),(0,i.kt)("td",{parentName:"tr",align:null},"The value in your login URL before your clientId, or the same as your clientId. It will be lower case")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"BRANDID")),(0,i.kt)("td",{parentName:"tr",align:null},"Unless you have multiple brands configured, this will be your accountId in upper case")))),(0,i.kt)("p",null,"The endpoint expects a POST of JSON data."),(0,i.kt)("p",null,"Authentication is via a shared secret passed in the auth-token header."),(0,i.kt)("p",null,"The actions are detailed below."),(0,i.kt)("h3",{id:"headers"},"Headers"),(0,i.kt)("h4",{id:"content-type"},"Content-Type"),(0,i.kt)("p",null,"You must provide a content-type header of application/json"),(0,i.kt)("h4",{id:"auth-token"},"Auth-Token"),(0,i.kt)("p",null,"Authentication to handled by a shared secret that must be passed in a header"),(0,i.kt)("h3",{id:"example-request"},"Example Request"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'curl "https://tracking.intilery.com/track/client/account/BRAND/v1/{action}" -i -X POST \\\n-H "content-type: application/json" \\\n-H "auth-token: 1234abcd" \\\n-d @event.json\n')),(0,i.kt)("h3",{id:"permissions"},"Permissions"),(0,i.kt)("p",null,"Your Authentication token will be set with permissions at the Account and Brand level, token\u2019s can be created that have access to all Brands within an Account or a token for each Brand (and account)."),(0,i.kt)("h3",{id:"limits"},"Limits"),(0,i.kt)("p",null,"The API is set to 100 requests per second with a burst of 500, limit and burst explained ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Token_bucket"},"here")),(0,i.kt)("p",null,"If limits are exceeded you will receive a 429 Error (limit exceeded) response."),(0,i.kt)("p",null,"The maximum size of any request is 1mb, exceeding this will return a 413 Error."),(0,i.kt)("h3",{id:"response"},"Response"),(0,i.kt)("p",null,"The API will respond with the appropriate HTTP response code, along with a body in the form of: -"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "success": true,\n    "eventId": "7f7211bf-94c8-4bfc-afb2-8a319d045cd6"\n}\n')),(0,i.kt)("p",null,"The eventID is a unique ID that is passed to all systems within the platform, this eventID can be used to query the status of the request (event) and receive any errors that occur"),(0,i.kt)("h4",{id:"response-error-codes"},"Response Error Codes"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Code"),(0,i.kt)("th",{parentName:"tr",align:null},"Reason"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"400"),(0,i.kt)("td",{parentName:"tr",align:null},"Client Error")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"403"),(0,i.kt)("td",{parentName:"tr",align:null},"No Token Supplied")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"403"),(0,i.kt)("td",{parentName:"tr",align:null},"Token Not Authorised (for the Account/Brand you are trying to access)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"429"),(0,i.kt)("td",{parentName:"tr",align:null},"Rate limit exceeded (there is a limit of 100 request/second, with a burst to 500)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"413"),(0,i.kt)("td",{parentName:"tr",align:null},"Request to large (there is a maximum size of 6Mb for a request)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"502"),(0,i.kt)("td",{parentName:"tr",align:null},"API returned an invalid response")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"503"),(0,i.kt)("td",{parentName:"tr",align:null},"API Unavailable")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"504"),(0,i.kt)("td",{parentName:"tr",align:null},"API timed out")))),(0,i.kt)("p",null,"A ",(0,i.kt)("inlineCode",{parentName:"p"},"400")," error response will return a JSON object with additional information on the error:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "success": false,\n    "message": "userId must not be empty"\n}\n')),(0,i.kt)("h2",{id:"identify-action"},"Identify Action"),(0,i.kt)("p",null,"identify lets you tie a user to their actions and record traits about them. It includes a unique User ID and any optional traits you know about them."),(0,i.kt)("p",null,"We recommend calling identify a single time when the user\u2019s account is first created, and only identifying again later when their traits change."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http",metastring:"request",request:!0},"POST https://tracking.intilery.com/track/{clientId}/{accountId}/{BRANDID}/v1/identify\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "userId": "123456",\n    "event":"identify",\n    "traits": {\n        "firstName": "Joe",\n        "lastName": "Bloggs",\n        "email": "joe.bloggs@example.com",\n        "marketingPreferences": { \n      "channels": [ \n        { "channel": "email", "subscribed": true },\n        { "channel": "sms", "subscribed": true },\n        { "channel": "whatsapp", "subscribed": false },\n        { "channel": "facebook", "subscribed": false },\n        { "channel": "push", "subscribed": false }\n      ] \n    }\n  },  \n  "context": {\n    "ip": "24.5.68.47"\n  },\n  "timestamp": "2019-11-18T13:30:11.444Z" \n }\n')),(0,i.kt)("p",null,"This call is identifying the user by their unique User ID (the one you know him by in your database) and setting their traits (attributes) with the values supplied."),(0,i.kt)("p",null,"Traits can be any valid JSON."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Field"),(0,i.kt)("th",{parentName:"tr",align:null}),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"userId")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"optional if anonymousID is set instead")),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"Unique identifier for the user in your database. A userId or an anonymousId is required. See the ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/identify#identities"},"Identities docs")," for more details.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"anonymousId")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"optional if userID is set instead")),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"A pseudo-unique substitute for a User ID, for cases when you don\u2019t have an absolutely unique identifier. A userId or an anonymousId is required.",(0,i.kt)("br",null),"See the ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/identify#identities"},"Identities docs")," for more details.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"event")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"required")),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"must be \u201c",(0,i.kt)("strong",{parentName:"td"},"identify"),"\u201d")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"traits")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"required")),(0,i.kt)("td",{parentName:"tr",align:null},"Object"),(0,i.kt)("td",{parentName:"tr",align:null},"Free-form dictionary of traits of the user, like email or firstName or an object like address")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"timestamp")),(0,i.kt)("td",{parentName:"tr",align:null},"optional"),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"http://en.wikipedia.org/wiki/ISO_8601"},"ISO-8601 UTC Timestamp")," (e.g. 2019-11-18T13:30:11.444Z), if not provided, it will be set at the time the event arrives at the server")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"context")),(0,i.kt)("td",{parentName:"tr",align:null},"optional"),(0,i.kt)("td",{parentName:"tr",align:null},"Object"),(0,i.kt)("td",{parentName:"tr",align:null},"Dictionary of extra information that provides useful context about a message, but is not directly related to the API call like ip address or locale")))),(0,i.kt)("h2",{id:"track-action"},"Track Action"),(0,i.kt)("p",null,"track lets you record the actions your users perform, record analytics for them or issue commands. Every action triggers what we call an \u201cevent\u201d, which can also have associated properties."),(0,i.kt)("p",null,"You\u2019ll want to track events that are indicators of success for your site, like registered, item purchased or logged in."),(0,i.kt)("p",null,"To get started, we recommend tracking just a few important events. You can always add more later!"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http",metastring:"request",request:!0},"POST https://tracking.intilery.com/track/{clientID}/{accountid}/{BRANDID}/v1/track\n")),(0,i.kt)("p",null,"Example added to basket event"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "userId":"ABC/123",  \n    "event":"Product Added",\n    "context":{\n        "page":{\n            "path":"/simplygosimplygo-pure-inulin/p-19868604-44086200",\n            "referrer":"",\n            "search":"",\n            "title":"Simplygo/simplygo-pure-inulin | Fruugo",\n            "url":"https://www.fruugo.co.uk/simplygosimplygo-pure-inulin/p-19868604-44086200"\n        },\n        "userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36"\n    },\n    "properties":{\n        "name":"Simplygo/simplygo-pure-inulin",\n        "product_id":"p-19868604-44086200",\n        "price":"11.99",\n        "cart_id":"1234",\n        "image_url":"https://img.fruugo.com/product/3/55/98531553_max.jpg",\n        "quantity":"1",\n        "url":"https://www.fruugo.co.uk/simplygosimplygo-pure-inulin/p-19868604-44086200",\n        "currency":"GBP"\n    },\n    "timestamp":"2019-11-28T14:31:58.596Z"\n}\n')),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Field"),(0,i.kt)("th",{parentName:"tr",align:null}),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"userId")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"optional if anonymousID is set instead")),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"Unique identifier for the user in your database. A userId or an anonymousId is required. See the ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/identify#identities"},"Identities docs")," for more details.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"anonymousId")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"optional if userID is set instead")),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"A pseudo-unique substitute for a User ID, for cases when you don\u2019t have an absolutely unique identifier. A userId or an anonymousId is required.",(0,i.kt)("br",null),"See the ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/identify#identities"},"Identities docs")," for more details.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"event")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"required")),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"Name of the action that a user has performed.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"timestamp")),(0,i.kt)("td",{parentName:"tr",align:null},"optional"),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"http://en.wikipedia.org/wiki/ISO_8601"},"ISO-8601 UTC Timestamp")," (e.g. 2019-11-18T13:30:11.444Z) for then the event happened, if not set, it is set by the server at the time the event is received")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"properties")),(0,i.kt)("td",{parentName:"tr",align:null},"optional"),(0,i.kt)("td",{parentName:"tr",align:null},"Object"),(0,i.kt)("td",{parentName:"tr",align:null},"Free-form dictionary of properties of the event, like price or sku")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"context")),(0,i.kt)("td",{parentName:"tr",align:null},"optional"),(0,i.kt)("td",{parentName:"tr",align:null},"Object"),(0,i.kt)("td",{parentName:"tr",align:null},"Dictionary of extra information that provides useful context about a message, but is not directly related to the API call like page or userAgent")))),(0,i.kt)("p",null,"The track endpoint can also be used to pass specific ",(0,i.kt)("a",{parentName:"p",href:"./commands"},"Track Action Commands"),"  to trigger campaign sends."),(0,i.kt)("h2",{id:"page-action"},"Page Action"),(0,i.kt)("p",null,"The page action lets you record page views on your website, along with optional extra information\nabout the page being viewed. The JavaScript tag will raise a page event whenever a new page is loaded."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http",metastring:"request",request:!0},"POST https://tracking.intilery.com/track/{clientID}/{accountid}/{BRANDID}/v1/page\n")),(0,i.kt)("p",null,"Example page call:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "event":"page", \n    "userId":"ABC/123",\n    "context": {\n      "page": {\n        "path": "/simplygosimplygo-pure-inulin/p-19868604-44086200",\n        "referrer": "",\n        "search": "",\n        "title": "Simplygo/simplygo-pure-inulin | Fruugo",\n        "url": "https://www.fruugo.co.uk/simplygosimplygo-pure-inulin/p-19868604-44086200"\n      },\n      "userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36"\n    },\n    "properties":{\n        "path":"/simplygosimplygo-pure-inulin/p-19868604-44086200",\n        "referrer":"", \n        "search":"", \n        "title":"Simplygo/simplygo-pure-inulin | Fruugo",\n        "url":"https://www.fruugo.co.uk/simplygosimplygo-pure-inulin/p-19868604-44086200" \n    },\n    "timestamp":"2019-11-28T14:50:16.519Z" \n}\n')),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Field"),(0,i.kt)("th",{parentName:"tr",align:null}),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"userId")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"optional if anonymousID is set instead")),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"Unique identifier for the user in your database. A userId or an anonymousId is required. See the ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/identify#identities"},"Identities docs")," for more details.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"anonymousId")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"optional if userID is set instead")),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"A pseudo-unique substitute for a User ID, for cases when you don\u2019t have an absolutely unique identifier. A userId or an anonymousId is required.",(0,i.kt)("br",null),"See the ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/identify#identities"},"Identities docs")," for more details.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"event")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"required")),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"must be \u201c",(0,i.kt)("strong",{parentName:"td"},"page"),"\u201d")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"timestamp")),(0,i.kt)("td",{parentName:"tr",align:null},"optional"),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"http://en.wikipedia.org/wiki/ISO_8601"},"ISO-8601 UTC Timestamp")," (e.g. 2019-11-18T13:30:11.444Z) for then the event happened, set on receipt if not provided")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"properties")),(0,i.kt)("td",{parentName:"tr",align:null},"optional"),(0,i.kt)("td",{parentName:"tr",align:null},"Object"),(0,i.kt)("td",{parentName:"tr",align:null},"Free-form dictionary of properties of the event, like price or sku")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"context")),(0,i.kt)("td",{parentName:"tr",align:null},"optional"),(0,i.kt)("td",{parentName:"tr",align:null},"Object"),(0,i.kt)("td",{parentName:"tr",align:null},"Dictionary of extra information that provides useful context about a message, but is not directly related to the API call like page or userAgent")))),(0,i.kt)("h2",{id:"screen-action"},"Screen Action"),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"/docs/schema/screen"},"screen")," method let you record whenever a user sees a screen of your mobile app."),(0,i.kt)("p",null,"You\u2019ll want to send the ",(0,i.kt)("inlineCode",{parentName:"p"},"screen")," message whenever a user requests a page of your app."),(0,i.kt)("p",null,"Example ",(0,i.kt)("inlineCode",{parentName:"p"},"screen")," call:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http",metastring:"request",request:!0},"POST https://tracking.intilery.com/track/{clientID}/{accountid}/{BRANDID}/v1/screen\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "userId": "019mr8mf4r",\n  "name": "Home",\n  "timestamp": "2012-12-02T00:31:29.738Z"\n}\n')),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"screen")," call has the following fields:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Field"),(0,i.kt)("th",{parentName:"tr",align:null}),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"anonymousId")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"optional if userID is set instead")),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"A pseudo-unique substitute for a User ID, for cases when you don\u2019t have an absolutely unique identifier. A userId or an anonymousId is required. See the ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/identify#identities"},"Identities docs")," for more details.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"context")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"optional")),(0,i.kt)("td",{parentName:"tr",align:null},"Object"),(0,i.kt)("td",{parentName:"tr",align:null},"Dictionary of extra information that provides useful context about a message, but is not directly related to the API call like ",(0,i.kt)("inlineCode",{parentName:"td"},"ip")," address or ",(0,i.kt)("inlineCode",{parentName:"td"},"locale")," See the ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/common#context"},"Context field docs")," for more details.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"name")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"optional")),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"Name of the screen See the ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/screen#name"},"Name field docs")," for more details.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"properties")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"optional")),(0,i.kt)("td",{parentName:"tr",align:null},"Object"),(0,i.kt)("td",{parentName:"tr",align:null},"Free-form dictionary of properties of the screen, like ",(0,i.kt)("inlineCode",{parentName:"td"},"name")," See the ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/screen#properties"},"Properties field docs")," for a list of reserved property names.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"timestamp")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"optional")),(0,i.kt)("td",{parentName:"tr",align:null},"Date"),(0,i.kt)("td",{parentName:"tr",align:null},"Timestamp when the message itself took place, defaulted to the current time by the Intilery Tracking API, as a ",(0,i.kt)("a",{parentName:"td",href:"http://en.wikipedia.org/wiki/ISO_8601"},"ISO-8601")," format date string. If the event just happened, leave it out and we\u2019ll use the server\u2019s time. If you\u2019re importing data from the past, make sure you to provide a ",(0,i.kt)("inlineCode",{parentName:"td"},"timestamp"),".See the ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/common#timestamps"},"Timestamps fields docs")," for more detail.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"userId")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"optional if anonymousID is set instead")),(0,i.kt)("td",{parentName:"tr",align:null},"String"),(0,i.kt)("td",{parentName:"tr",align:null},"Unique identifier for the user in your database. A userId or an anonymousId is required. See the ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/identify#identities"},"Identities docs")," for more details.")))),(0,i.kt)("p",null,"Find details on the ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"screen")," payload")," in our ",(0,i.kt)("a",{parentName:"p",href:"/docs/schema/screen"},"Spec"),"."),(0,i.kt)("h2",{id:"historical-import"},"Historical Import"),(0,i.kt)("p",null,"You can import historical data by adding the ",(0,i.kt)("inlineCode",{parentName:"p"},"timestamp")," argument to any of your method calls. This can be helpful if you\u2019ve just switched to Intilery."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Note:")," If you\u2019re tracking things that are happening right now, leave out the ",(0,i.kt)("inlineCode",{parentName:"p"},"timestamp")," and our servers will timestamp the requests for you."),(0,i.kt)("h2",{id:"batch"},"Batch"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"batch")," method lets you send a series of ",(0,i.kt)("inlineCode",{parentName:"p"},"identify"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"group"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"track"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"page")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"screen")," requests in a single batch, saving on outbound requests."),(0,i.kt)("p",null,"There is a maximum of ",(0,i.kt)("inlineCode",{parentName:"p"},"1mb")," per batch request and ",(0,i.kt)("inlineCode",{parentName:"p"},"32KB")," per call."),(0,i.kt)("p",null,"Here\u2019s the what the ",(0,i.kt)("inlineCode",{parentName:"p"},"batch")," request signature looks like:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http",metastring:"request",request:!0},"POST https://tracking.intilery.com/track/{clientID}/{accountid}/{BRANDID}/v1/batch\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "batch": [\n    {\n      "event": "identify",\n      "userId": "019mr8mf4r",\n      "traits": {\n        "email": "jake@yahoo.com",\n        "name": "Jake Peterson",\n        "age": 26\n      },\n      "timestamp": "2012-12-02T00:30:08.276Z"\n    },\n    {\n      "event": "Song Played",\n      "userId": "019mr8mf4r",\n      "properties": {\n        "name": "Fallin for You",\n        "artist": "Dierks Bentley"\n      },\n      "timestamp": "2012-12-02T00:30:12.984Z"\n    },\n    {\n      "event": "identify",\n      "userId": "971mj8mk7p",\n      "traits": {\n        "email": "cindy@example.com",\n        "name": "Cindy Gonzalez",\n        "age": 23\n      },\n      "timestamp": "2015-2-02T00:30:08.276Z"\n    },\n    {\n      "event": "Song Played",\n      "userId": "971mj8mk7p",\n      "properties": {\n        "name": "Get Right",\n        "artist": "Jennifer Lopez"\n      },\n      "timestamp": "2015-2-02T00:30:12.984Z"\n    }\n  ],\n  "context": {\n    "device": {\n      "type": "phone",\n      "name": "Apple iPhone 6"\n    }\n  }\n}\n')),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Field"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"batch")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Array")),(0,i.kt)("td",{parentName:"tr",align:null},"An array of ",(0,i.kt)("inlineCode",{parentName:"td"},"identify"),", ",(0,i.kt)("inlineCode",{parentName:"td"},"group"),", ",(0,i.kt)("inlineCode",{parentName:"td"},"track"),", ",(0,i.kt)("inlineCode",{parentName:"td"},"page")," and ",(0,i.kt)("inlineCode",{parentName:"td"},"screen")," method calls. Each call ",(0,i.kt)("strong",{parentName:"td"},"must")," have an ",(0,i.kt)("inlineCode",{parentName:"td"},"event")," property with a valid method name.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"context")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Object, optional")),(0,i.kt)("td",{parentName:"tr",align:null},"The same as ",(0,i.kt)("a",{parentName:"td",href:"/docs/schema/common#context"},"Context")," for other calls, but it will be merged with any context inside each of the items in the batch.")))),(0,i.kt)("h2",{id:"collecting-ip-address"},"Collecting IP Address"),(0,i.kt)("p",null,"When sending a HTTP call from a user\u2019s device, you can collect the IP address by setting ",(0,i.kt)("inlineCode",{parentName:"p"},"context.direct")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,i.kt)("h2",{id:"deletion-and-suppression"},"Deletion and Suppression"),(0,i.kt)("p",null,"In keeping with our commitment to support GDPR and future privacy regulations such as the CCPA,\nwe offer the ability to delete and suppress data about end users if they are identified by a ",(0,i.kt)("inlineCode",{parentName:"p"},"userId"),",\nshould they revoke or alter their consent to data collection. For instance, if an end user in the EU invokes\ntheir Right to Object or Right to Erasure under the GDPR, you can use the following features in Intilery to block\nongoing data collection about the user, and additionally to delete all historical data across Intilery's systems,\nconnected S3 buckets and warehouses."),(0,i.kt)("p",null,"All deletion and suppression actions within Intilery are asynchronous, and fall under the umbrella of what we call \u201cRegulations.\u201d\nRegulations are requests to Intilery to impart control over your data flow."),(0,i.kt)("p",null,"Regulations enable you to issue a single request to delete and suppress data about a user by ",(0,i.kt)("inlineCode",{parentName:"p"},"userId"),"."),(0,i.kt)("h3",{id:"regulation-types"},"Regulation types"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,i.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"Suppress and Delete"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Suppress new data and delete existing data")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"Delete"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Delete existing data (only available when suppressed)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"Unsuppress"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Stop an ongoing suppression")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"Suppress"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Suppress new data without deleting existing data")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"NoTrack"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Stops track events, but you can still send messages (emails, SMS, etc...) and send commands and identify via the API, but not via the JS Tag")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"Track"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Undo the NoTrack")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:"left"},"Access"),(0,i.kt)("td",{parentName:"tr",align:"left"},"Request the data held on the user to be supplied as a zip file")))),(0,i.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,i.kt)("p",null,"If you\u2019re having trouble we have a few tips that help common problems."),(0,i.kt)("h3",{id:"no-events-in-my-debugger"},"No events in my debugger"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Double check that you\u2019ve set up the library correctly."),(0,i.kt)("li",{parentName:"ol"},"Make sure that you\u2019re calling one of our API methods once the library is successfully installed\u2014",(0,i.kt)("a",{parentName:"li",href:"./api/#identify"},(0,i.kt)("inlineCode",{parentName:"a"},"identify")),", ",(0,i.kt)("a",{parentName:"li",href:"./api#track"},(0,i.kt)("inlineCode",{parentName:"a"},"track")),", etc.")))}u.isMDXComponent=!0}}]);